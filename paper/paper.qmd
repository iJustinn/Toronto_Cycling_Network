---
title: "Geospatial and Temporal Analysis of Toronto's Cycling Infrastructure"
subtitle: "A Data-Driven Approach"
author: 
  - Ziheng Zhong
thanks: "Code and data are available at: https://github.com/iJustinn/Toronto_Cycling_Network"
date: today
date-format: long
abstract: "This paper explores the development of Toronto's cycling infrastructure. Through a comprehensive analysis of installation dates, upgrades, and comfort levels of bike lanes, this study highlights the trends in cycling infrastructure expansion from 2001 to 2024. A significant focus is placed on the comfort levels of different types of lanes, offering insights into how the infrastructure meets the needs of cyclists. The spatial distribution of bike lanes is also analyzed, revealing discrepancies in access between downtown and suburban areas. The findings emphasize the need for continued investment in both the quality and expansion of cycling infrastructure to promote sustainable transportation in Toronto."
format: pdf
toc: true
toc-depth: 3
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

# Load packages
package_list <- c("sf", "readr", "ggplot2", "osmdata", "tidyverse", "jsonlite", "dplyr", "here", "knitr", "kableExtra")

# Function to check and install missing packages
install_and_load <- function(package_list) {
  for (package in package_list) {
    if (!require(package, character.only = TRUE)) {
      install.packages(package)
      library(package, character.only = TRUE)
    }
  }
}

install_and_load(package_list)
```



# Introduction

Urban cycling plays a critical role in advancing sustainable transportation strategies, especially in rapidly growing cities like Toronto. With the city facing increasing congestion, promoting active transportation modes such as cycling is essential for reducing greenhouse gas emissions, improving public health, and enhancing urban mobility. Since the early 2000s, Toronto has made significant strides in expanding its cycling infrastructure, creating a network of bike lanes, multi-use paths, and shared roadways to support cyclists citywide.

This paper analyzes the evolution of Toronto's cycling infrastructure over the past two decades, focusing on the installation and upgrade trends of bikeways and their classification by comfort level. Using the 'Cycling Network' dataset from Open Data Toronto, the study examines both the spatial distribution of bike lanes and the varying levels of cycling comfort across different regions. The analysis highlights discrepancies between downtown and suburban areas, showcasing progress while identifying regions that remain underserved.

The study's findings underscore the need for continued investment in both the expansion and quality of Toronto's cycling infrastructure to encourage more widespread adoption of cycling as a viable mode of transportation. By addressing both the geographic imbalances and comfort levels of bike lanes, the city can better meet its sustainability goals. 

The structure of this paper is as follows: the data sources and methodologies are presented in @sec-data, followed by an analysis of the results in @sec-res, and a discussion of the findings in @sec-dis.

# Data {#sec-data}

## Source
The dataset analyzed in this study, the Cycling Network dataset [@citeCyclingNetwork], was retrieved from Open Data Toronto [@citeODT]. This dataset is publicly available and is continually updated to reflect Toronto’s ongoing efforts to develop and maintain its cycling infrastructure. It contains geospatial and temporal information about various cycling-related features, including the types of bikeways (dedicated lanes, shared roads, multi-use trails), installation years, and any subsequent upgrades. By offering a detailed history of Toronto's cycling network development, this dataset plays a vital role in informing both urban planning policies and research into sustainable transportation options.

While the Cycling Network dataset was the primary source of data, other relevant datasets were explored, such as the Road Network File [@citeStatCan] from Statistics Canada, which provides detailed geospatial data on all roadways in Toronto. Another such alternative was the Major City-Wide Cycling Routes dataset [@citeCyclingRoutes], also available on Open Data Toronto [@citeODT]. However, this dataset focuses specifically on the large-scale cycling routes connecting different parts of the city, emphasizing connectivity at a macro level. While these two dataset are useful for analyzing high-level transportation patterns, it lacks the detailed, segment-level data—such as comfort levels, installation dates, and upgrade history—that are crucial for a deep analysis of cycling infrastructure. Since this paper focuses on both the growth and quality of cycling infrastructure, the Cycling Network dataset, with its more comprehensive coverage of individual bikeway segments, was a better fit for the goals of this study.

Data used in this paper was downloaded, cleaned and analyzed with the programming language R [@citeR]. Also with support of additional packages which will be mentioned later in the @sec-data-method.

## Measurement

The 'Cycling Network' dataset from Open Data Toronto tracks various aspects of Toronto's cycling infrastructure, such as installation dates, upgrades, street names, and the type of infrastructure (e.g., sharrows, multi-use trails). Each entry represents a segment of the cycling network, where real-world phenomena, such as the construction or upgrading of cycling paths, are documented. For example, when a cycling path is installed or upgraded, the responsible authorities collect information such as the installation year (e.g., 2001) and any subsequent upgrades (e.g., 2021). This data is then digitized into structured entries in the dataset.

To go from a physical event (e.g., the installation of a bike lane) to a dataset entry, detailed records are maintained by the city's transportation department. These records are geospatially coded (column geometry in this dataset), allowing each cycling path to be mapped precisely in relation to other city infrastructure. Thus, the phenomena of constructing or updating a bike lane becomes an entry with attributes such as the street name, road class, and installation history. This allows researchers to analyze trends in cycling infrastructure and its expansion over time.

### Variables

As mentioend above, the dataset contains several key variables that were used in this analysis:

#### Installation Year

The Installation Year records the year in which a particular bikeway segment was first constructed or made available for use. This variable is essential for conducting a temporal trend analysis, allowing the study to track the growth and expansion of the cycling network over time.

#### Upgrade Year

The Upgrade Year indicates when an existing bikeway segment was upgraded or improved. Upgrades typically involve safety enhancements, such as the installation of protective barriers, widening of lanes, or changes from painted lanes to physically separated lanes. This variable is critical for assessing not just the expansion but also the quality improvements made to Toronto’s cycling infrastructure over time. Tracking upgrades helps to understand whether the city's focus has shifted from merely adding new bikeways to improving the usability and safety of existing ones, especially in high-traffic or critical areas.

#### Bikeway Type

The Bikeway Type categorizes the cycling infrastructure into different types, including dedicated bike lanes, multi-use trails, and shared roadways, etc. Each type of bikeway offers varying levels of protection and comfort to cyclists. This variable was not directly used in the study, but forming another crucial variable: Comfort Level.

#### Comfort Level
Each bikeway is assigned a comfort level—high, moderate, or low—based according to the recorded Bikeway Type. These classification are self-defined, reling on factors such as physical separation from traffic and lane width of each Bikeway Type, detail can be found in @sec-app-comfort. This variable is central to understanding the usability of the infrastructure.

#### Geospatial Coordinates
Latitude and longitude data are included to map the bikeways and assess their spatial distribution.

## Method {#sec-data-method}

Data used in this paper was cleaned, processed, modeled and tested with the programming language R [@citeR]. Also with support of additional packages in R: `sf` [@citeSf], `readr` [@citeReadr], `ggplot2` [@citeGgplot2], `osmdata` [@citeOsmdata], `tidyverse` [@citeTidyverse], `jsonlite` [@citeJsonlite], `dplyr` [@citeDplyr], `here` [@citeHere], `knitr` [@citeKnitr], `kableExtra` [@citeKableExtra].

```{r}
#| echo: false
#| eval: true
#| label: tbl-raw-coordinates
#| tbl-cap: "Raw Coordinates"
#| warning: false

# Load the dataset
data <- read_csv(here("data", "raw_data", "raw_data.csv"))

# Extract the first part of the geometry string for each row
data_geometry <- data %>%
  mutate(simplified_geometry = substr(geometry, 1, 92)) %>%  # Extract the first 100 characters
  select(simplified_geometry)

# Display the simplified geometry data
head(data_geometry) %>%
  kable("latex", booktabs = TRUE, col.names = c("Geometry")) %>%
  column_spec(1, width = "40em")  # Adjust the width as needed

```

```{r}
#| echo: false
#| eval: true
#| label: tbl-clean-coordinates
#| tbl-cap: "Extracted and Cleaned Coordinates"
#| warning: false


# Load the dataset
data <- read_csv(here("data", "raw_data", "raw_data.csv"))

# Function to extract and clean coordinates from geometry
extract_coordinates <- function(geo) {
  if (!is.na(geo)) {
    geo_clean <- gsub("'", "\"", geo)
    json_data <- tryCatch({
      fromJSON(geo_clean)
    }, error = function(e) {
      return(NULL)
    })
    
    if (!is.null(json_data) && !is.null(json_data$coordinates)) {
      coords <- unlist(json_data$coordinates, recursive = TRUE)
      longitude <- coords[grepl("^-79", coords)]
      latitude <- coords[grepl("^43", coords)]
      if (length(longitude) == length(latitude)) {
        coords_matrix <- cbind(longitude, latitude)
        return(as.data.frame(coords_matrix))
      }
    }
  }
  return(NULL)
}

# Extract coordinates and clean data
all_coordinates <- lapply(data$geometry, extract_coordinates)
valid_coordinates <- all_coordinates[!sapply(all_coordinates, is.null)]
data$id <- seq_len(nrow(data))
coordinates_data <- do.call(rbind, Map(function(coords, id) {
  coords$id <- id
  return(coords)
}, valid_coordinates, data$id[!sapply(all_coordinates, is.null)]))

# Set column names and remove NA values
colnames(coordinates_data) <- c("Longitude", "Latitude", "ID")
coordinates_data <- coordinates_data %>% filter(!is.na(Longitude), !is.na(Latitude))

# Display the first few rows of the cleaned coordinate data
head(coordinates_data) %>%
  kable("latex", booktabs = TRUE, col.names = c("Longitude", "Latitude", "ID"))

```

In the first data cleaning process, the focus was on extracting and cleaning geographical coordinates from the 'geometry' column, which contains location data in JSON-like format, @tbl-raw-coordinates displays how the data was like. A custom function was created to parse the coordinates, filter out invalid entries, and extract the longitude and latitude values. The extracted coordinates were combined into a new dataset shon in @tbl-clean-coordinates, with unique IDs to match the original entries. Any rows with missing coordinate data were removed, and the cleaned data was saved into a separate file for further analysis.

```{r}
#| echo: false
#| eval: true
#| label: tbl-clean-upgraded
#| tbl-cap: "Number of Bikeways Upgraded by Year"
#| warning: false

# Load the dataset
data <- read_csv(here("data", "raw_data", "raw_data.csv"))

# Step 1: Select the 'UPGRADED' column
upgraded_data <- data %>%
  select(UPGRADED)

# Step 2: Filter out invalid and missing years
upgraded_data <- upgraded_data %>%
  filter(!is.na(UPGRADED) & UPGRADED > 1800)  # Keep valid years only

# Step 3: Convert the 'UPGRADED' column to numeric
upgraded_data <- upgraded_data %>%
  mutate(UPGRADED = as.numeric(UPGRADED))

# Step 4: Group the data by the year of upgrade and summarize the number of upgrades
upgraded_summary <- upgraded_data %>%
  group_by(UPGRADED) %>%
  summarise(num_lanes = n())

# Step 5: Display the summarized data in a table
tail(upgraded_summary) %>%
  kable("latex", booktabs = TRUE, col.names = c("Year", "Total Upgraded"))

```

The second cleaning process dealt with the 'UPGRADED' column, which contains information about the years when cycling lanes were upgraded. Invalid or missing years were filtered out, and the remaining valid data was converted to a numeric format. The dataset was then grouped by the year of upgrade, with a summary created to count the number of lanes upgraded in each year. This summarized data, @tbl-clean-upgraded, was saved for use in analyzing trends in lane upgrades over time.

```{r}
#| echo: false
#| eval: true
#| label: tbl-clean-installed
#| tbl-cap: "Number of Bikeways Installed by Year"
#| warning: false

# Load the dataset
data <- read_csv(here("data", "raw_data", "raw_data.csv"))

# Step 1: Select the 'INSTALLED' column
installed_data <- data %>%
  select(INSTALLED)

# Step 2: Filter out invalid and missing years
installed_data <- installed_data %>%
  filter(!is.na(INSTALLED) & INSTALLED > 1800)  # Keep valid years only

# Step 3: Convert the 'INSTALLED' column to numeric
installed_data <- installed_data %>%
  mutate(INSTALLED = as.numeric(INSTALLED))

# Step 4: Group the data by the year of installation and summarize the number of installations
installed_summary <- installed_data %>%
  group_by(INSTALLED) %>%
  summarise(num_bikeways = n())

# Step 5: Display only the first 6 rows of the summarized data in a table
head(installed_summary) %>%
  kable("latex", booktabs = TRUE, col.names = c("Year", "Total Installed"))

```

In the third cleaning process, the focus was on the 'INSTALLED' column, which records the years when cycling infrastructure was first installed. Similar to the 'UPGRADED' column, invalid or missing years were removed, and the data was converted to numeric format. The installation data was grouped by year to count the number of bikeways installed each year. The resulting summary, @tbl-clean-installed, was saved for further trend analysis on the growth of the cycling network.

```{r}
#| echo: false
#| eval: true
#| label: tbl-clean-comfort
#| tbl-cap: "Classification of Cycling Lanes by Comfort Level"
#| warning: false

# Load the dataset
data <- read_csv(here("data", "raw_data", "raw_data.csv"))

# Step 1: Select relevant columns for classification
lane_type_data <- data %>%
  select(INFRA_HIGHORDER, INFRA_LOWORDER, INSTALLED, UPGRADED)

# Step 2: Filter out rows with missing values in the relevant columns
lane_type_data <- lane_type_data %>%
  filter(!is.na(INFRA_HIGHORDER) & !is.na(INFRA_LOWORDER))

# Step 3: Classify lanes into comfort levels based on infrastructure types
lane_type_data <- lane_type_data %>%
  mutate(
    Comfort_Level = case_when(
      str_detect(INFRA_HIGHORDER, "Protected|Multi-Use") | str_detect(INFRA_LOWORDER, "Protected|Multi-Use") ~ "High Comfort",
      str_detect(INFRA_HIGHORDER, "Bike Lane") | str_detect(INFRA_LOWORDER, "Bike Lane") ~ "Moderate Comfort",
      TRUE ~ "Low Comfort"
    )
  )

# Step 4: Select relevant columns to display (Comfort Level, Installed, and Upgraded year)
final_lane_data <- lane_type_data %>%
  select(INSTALLED, UPGRADED, Comfort_Level)

# Step 5: Display the first 6 rows of the cleaned and classified data
head(final_lane_data) %>%
  kable("latex", booktabs = TRUE, col.names = c("Installed Year", "Upgraded Year", "Comfort Level"))

```

Finally, the fourth cleaning process involved classifying cycling lanes based on the type of infrastructure. Data from the 'INFRA_HIGHORDER' and 'INFRA_LOWORDER' columns was cleaned, and missing values were removed. The lanes were classified into three comfort levels: High Comfort, Moderate Comfort, and Low Comfort, depending on their Bikeway Type data, detail of this classification can be found in @sec-app-comfort. The classification, along with year data for installation and upgrades, was saved for analysis on the types of cycling lanes and their comfort levels. @tbl-clean-comfort shows how it looks like.

# Results {#sec-res}

## Data Trend

```{r}
#| label: fig-installed
#| fig-cap: "Toronto Bikeways Installed by Year"
#| fig-subcap: ["Number", "Trend"]
#| echo: false
#| warning: false
#| message: false
#| layout-ncol: 2
#| layout-nrow: 1

# Load the data
installed_data <- read_csv(here("data", "analysis_data", "installed_data.csv"))

# Generate the bar chart for "Number of Bikeways Installed by Year"
ggplot(installed_data, aes(x = INSTALLED, y = num_bikeways)) +
  geom_bar(stat = "identity", fill = "darkgrey") +  # Bar chart
  labs(x = "Year of Installation",
       y = "Number of Bikeways") +
  scale_x_continuous(breaks = seq(min(installed_data$INSTALLED), max(installed_data$INSTALLED), by = 1)) +  # Display all years
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotates x-axis labels for readability



# Generate the line chart with trend line for "Number of Bikeways Installed by Year"
ggplot(installed_data, aes(x = INSTALLED, y = num_bikeways)) +
  geom_line(aes(group = 1), color = "black", size = 1) +  # Adds a line connecting each point
  geom_point(color = "black", size = 2) +  # Adds points at each data value
  geom_smooth(method = "lm", color = "red", se = FALSE) +  # Adds a linear trend line
  labs(x = "Year of Installation",
       y = "Number of Bikeways") +
  scale_x_continuous(breaks = seq(min(installed_data$INSTALLED), max(installed_data$INSTALLED), by = 1)) +  # Display all years
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotates x-axis labels for readability

```

@fig-installed consists of two panels depicting the number of bikeways installed in Toronto by year, alongside a trend analysis of the installation pattern over time. @fig-installed-1 displays the raw count of bikeways installed per year from 2001 to 2024. A significant spike is observed in 2001, with over 400 bikeways installed in that year alone. This likely reflects a major investment in cycling infrastructure at the time. Following 2001, the number of installations drops sharply and stabilizes at much lower levels in subsequent years, with occasional small peaks around 2007, 2011, and 2021.

@fig-installed-2 adds a trend line to the same data, showing a gradual decline in the number of bikeways installed over time. The trend line, sloping downward, indicates that despite some fluctuations, the overall pattern is a decrease in annual bikeway installations. The early 2000s marked a high point for cycling infrastructure development, but after this surge, the rate of installation has steadily declined. This trend might reflect a shift in city planning priorities or the saturation of available spaces for bikeways in certain areas. The analysis highlights the need for renewed focus on expanding cycling infrastructure to sustain or increase the momentum of bike-friendly urban development.

```{r}
#| label: fig-upgraded
#| fig-cap: "Toronto Bikeways Upgraded by Year"
#| fig-subcap: ["Number", "Trend"]
#| echo: false
#| warning: false
#| message: false
#| layout-ncol: 2
#| layout-nrow: 1

# Load the data
upgraded_data <- read_csv(here("data", "analysis_data", "upgraded_data.csv"))

# Generate the bar chart for "Number of Bikeways Upgraded by Year"
ggplot(upgraded_data, aes(x = UPGRADED, y = num_lanes)) +
  geom_bar(stat = "identity", fill = "darkgrey") +  # Bar chart
  labs(x = "Year of Upgrade",
       y = "Number of Bikeways") +
  scale_x_continuous(breaks = seq(min(upgraded_data$UPGRADED), max(upgraded_data$UPGRADED), by = 1)) +  # Display all years
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotates x-axis labels for readability



# Generate the line chart with trend line for "Number of Bikeways Upgraded by Year"
ggplot(upgraded_data, aes(x = UPGRADED, y = num_lanes)) +
  geom_line(aes(group = 1), color = "black", size = 1) +  # Adds a line connecting each point
  geom_point(color = "black", size = 2) +  # Adds points at each data value
  geom_smooth(method = "lm", color = "red", se = FALSE) +  # Adds a linear trend line
  labs(x = "Year of Upgrade",
       y = "Number of Bikeways") +
  scale_x_continuous(breaks = seq(min(upgraded_data$UPGRADED), max(upgraded_data$UPGRADED), by = 1)) +  # Display all years
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotates x-axis labels for readability

```

@fig-upgraded illustrates the number of bikeways upgraded in Toronto from 2001 to 2023, with panel (a) showing the raw counts of upgrades and panel (b) visualizing the trend. @fig-upgraded-1 reveals that the most significant number of upgrades occurred in 2015, where nearly 100 bikeways were updated, marking a major peak. Outside of this spike, the number of annual upgrades remains relatively modest, typically fluctuating between 10 and 50 bikeways. Notable periods of increased upgrades are visible around 2012 and 2020, possibly reflecting concentrated efforts to modernize or expand existing cycling infrastructure in those years.

In @fig-upgraded-2, the overall trend is slightly upward, as indicated by the red trend line. Despite the notable peaks and valleys, the trend line suggests that, on average, the number of bikeway upgrades has increased over the years. The spike in 2015 significantly affects the trend, but even excluding that, the gradual rise suggests that more consistent efforts have been made to maintain and improve Toronto’s cycling network. This trend aligns with broader urban planning strategies focused on making cities more accessible and environmentally friendly by supporting active transportation. The dips in recent years, particularly after 2020, might be influenced by resource reallocation or external factors, such as the global pandemic, which could have delayed infrastructure projects.

## Distributions

```{r}
#| label: fig-comfort-one
#| fig-cap: "Toronto Bikeway Comfort Level Distribution"
#| fig-subcap: ["Comfort Levels", "Low Comfort"]
#| echo: false
#| warning: false
#| message: false
#| layout-ncol: 2
#| layout-nrow: 1
#| fig-width: 12
#| fig-height: 7

# Load the data
lane_type_data <- read_csv(here("data", "analysis_data", "lane_type_data.csv"))

# Combine the 'INSTALLED' and 'UPGRADED' years into one column for better visualization
lane_type_years <- lane_type_data %>%
  pivot_longer(cols = c(INSTALLED, UPGRADED), names_to = "Year_Type", values_to = "Year") %>%
  filter(!is.na(Year)) %>%  # Remove NA values in the 'Year' column
  group_by(Comfort_Level) %>%
  summarise(count = n())  # Count the occurrences of each Comfort Level

# Calculate percentages
lane_type_years <- lane_type_years %>%
  mutate(percentage = round((count / sum(count)) * 100, 2))  # Add percentage column

# Define a more contrasting Morandi-inspired color scheme
contrasting_morandi_colors <- c(
  "High Comfort" = "#B39B8E",   # Muted brownish-pink
  "Moderate Comfort" = "#8A7967", # Stronger grey-brown
  "Low Comfort" = "#6E7062"     # Dark muted gray-green
)

# Generate the pie chart with border lines and larger text/legend
ggplot(lane_type_years, aes(x = "", y = percentage, fill = Comfort_Level)) +
  geom_bar(stat = "identity", width = 1, color = "black") +  # Add black border lines around pie sections
  coord_polar("y", start = 0) +
  geom_text(aes(label = paste0(percentage, "%")), 
            position = position_stack(vjust = 0.5), 
            size = 6,   # Increase text size for percentage labels
            fontface = "bold") +  # Make percentage text bold
  scale_fill_manual(values = contrasting_morandi_colors) +  # Apply the more contrasting Morandi colors
  labs(fill = "Comfort Level") +
  theme_void() +  # Remove axis, grid lines, and background
  theme(legend.position = "right", 
        legend.title = element_text(size = 16),  # Increase legend title size
        legend.text = element_text(size = 14))  # Increase legend text size



# Filter data for 'Low Comfort' lanes and categorize as 'Upgraded' or 'Not Upgraded'
low_comfort_data <- lane_type_data %>%
  filter(Comfort_Level == "Low Comfort") %>%
  mutate(
    Upgrade_Status = ifelse(is.na(UPGRADED), "Not Upgraded", "Upgraded")
  ) %>%
  group_by(Upgrade_Status) %>%
  summarise(count = n())  # Count the occurrences of each category

# Calculate percentages
low_comfort_data <- low_comfort_data %>%
  mutate(percentage = round((count / sum(count)) * 100, 2))  # Add percentage column

# Define colors for 'Upgraded' and 'Not Upgraded' categories
upgrade_colors_low <- c(
  "Upgraded" = "#8A7967",  # Gray-brown for upgraded
  "Not Upgraded" = "#B39B8E"  # Muted pinkish tone for not upgraded
)

# Generate the pie chart with borders and larger text/legend for Low Comfort lanes
ggplot(low_comfort_data, aes(x = "", y = percentage, fill = Upgrade_Status)) +
  geom_bar(stat = "identity", width = 1, color = "black") +  # Add black border lines around pie sections
  coord_polar("y", start = 0) +
  geom_text(aes(label = paste0(percentage, "%")), 
            position = position_stack(vjust = 0.5), 
            size = 6,   # Increase text size for percentage labels
            fontface = "bold") +  # Make percentage text bold
  scale_fill_manual(values = upgrade_colors_low) +  # Apply colors for Upgraded vs Not Upgraded
  labs(fill = "Upgrade Status") +
  theme_void() +  # Remove axis, grid lines, and background
  theme(legend.position = "right", 
        legend.title = element_text(size = 16),  # Increase legend title size
        legend.text = element_text(size = 14))  # Increase legend text size

```

@fig-comfort-one provides a breakdown of Toronto’s bikeway network by comfort level and upgrade status. @fig-comfort-one-1 shows the distribution of all bikeways based on comfort level, with the majority of bikeways classified as either Low Comfort (41.6%) or Moderate Comfort (41.1%), while High Comfort lanes constitute a smaller portion (17.3%). This indicates that while Toronto has invested in a significant number of bike lanes, most of them fall within lower comfort categories, suggesting that further improvements, particularly in upgrading existing lanes, are needed to promote safer and more comfortable cycling experiences.

```{r}
#| label: fig-comfort-two
#| fig-cap: "Toronto Bikeway Comfort Level Distribution"
#| fig-subcap: ["Moderate Comfort", "High Comfort"]
#| echo: false
#| warning: false
#| message: false
#| layout-ncol: 2
#| layout-nrow: 1
#| fig-width: 12
#| fig-height: 7

# Load the data
lane_type_data <- read_csv(here("data", "analysis_data", "lane_type_data.csv"))

# Filter data for 'Moderate Comfort' lanes and categorize as 'Upgraded' or 'Not Upgraded'
moderate_comfort_data <- lane_type_data %>%
  filter(Comfort_Level == "Moderate Comfort") %>%
  mutate(
    Upgrade_Status = ifelse(is.na(UPGRADED), "Not Upgraded", "Upgraded")
  ) %>%
  group_by(Upgrade_Status) %>%
  summarise(count = n())  # Count the occurrences of each category

# Calculate percentages
moderate_comfort_data <- moderate_comfort_data %>%
  mutate(percentage = round((count / sum(count)) * 100, 2))  # Add percentage column

# Define colors for 'Upgraded' and 'Not Upgraded' categories
upgrade_colors_moderate <- c(
  "Upgraded" = "#8A7967",  # Gray-brown for upgraded
  "Not Upgraded" = "#B39B8E"  # Muted pinkish tone for not upgraded
)

# Generate the pie chart for Moderate Comfort lanes
ggplot(moderate_comfort_data, aes(x = "", y = percentage, fill = Upgrade_Status)) +
  geom_bar(stat = "identity", width = 1, color = "black") +  # Add black border lines around pie sections
  coord_polar("y", start = 0) +
  geom_text(aes(label = paste0(percentage, "%")), 
            position = position_stack(vjust = 0.5), 
            size = 6,   # Increase text size for percentage labels
            fontface = "bold") +  # Make percentage text bold
  scale_fill_manual(values = upgrade_colors_moderate) +  # Apply colors for Upgraded vs Not Upgraded
  labs(fill = "Upgrade Status") +
  theme_void() +  # Remove axis, grid lines, and background
  theme(legend.position = "right", 
        legend.title = element_text(size = 16),  # Increase legend title size
        legend.text = element_text(size = 14))  # Increase legend text size



# Filter data for 'High Comfort' lanes and categorize as 'Upgraded' or 'Not Upgraded'
high_comfort_data <- lane_type_data %>%
  filter(Comfort_Level == "High Comfort") %>%
  mutate(
    Upgrade_Status = ifelse(is.na(UPGRADED), "Not Upgraded", "Upgraded")
  ) %>%
  group_by(Upgrade_Status) %>%
  summarise(count = n())  # Count the occurrences of each category

# Calculate percentages
high_comfort_data <- high_comfort_data %>%
  mutate(percentage = round((count / sum(count)) * 100, 2))  # Add percentage column

# Define colors for 'Upgraded' and 'Not Upgraded' categories
upgrade_colors_high <- c(
  "Upgraded" = "#8A7967",  # Gray-brown for upgraded
  "Not Upgraded" = "#B39B8E"  # Muted pinkish tone for not upgraded
)

# Generate the pie chart for High Comfort lanes
ggplot(high_comfort_data, aes(x = "", y = percentage, fill = Upgrade_Status)) +
  geom_bar(stat = "identity", width = 1, color = "black") +  # Add black border lines around pie sections
  coord_polar("y", start = 0) +
  geom_text(aes(label = paste0(percentage, "%")), 
            position = position_stack(vjust = 0.5), 
            size = 6,   # Increase text size for percentage labels
            fontface = "bold") +  # Make percentage text bold
  scale_fill_manual(values = upgrade_colors_high) +  # Apply colors for Upgraded vs Not Upgraded
  labs(fill = "Upgrade Status") +
  theme_void() +  # Remove axis, grid lines, and background
  theme(legend.position = "right", 
        legend.title = element_text(size = 16),  # Increase legend title size
        legend.text = element_text(size = 14))  # Increase legend text size

```

@fig-comfort-one-2, @fig-comfort-two-1, and @fig-comfort-two-2 offer a deeper look into the upgrade status for each comfort level. For Low Comfort lanes, only 22.69% have been upgraded, while 77.31% remain in their original state. Similarly, for Moderate Comfort bikeways, 23.38% have been upgraded, leaving 76.62% untouched. Interestingly, High Comfort lanes have the lowest proportion of upgrades, with only 18.76% improved, despite representing the most comfortable and potentially most desirable biking infrastructure. These trends highlight a potential gap in Toronto's focus on maintaining and upgrading its most comfortable and accessible cycling lanes, suggesting a need for more targeted investments in high-comfort bikeways to encourage broader use of cycling for transportation.

## Maps

```{r}
#| label: fig-map
#| fig-cap: "Map of Bike Lanes Locations in Toronto"
#| echo: false
#| warning: false
#| message: false
#| fig-width: 11
#| fig-height: 8

# Load the data
coordinates_data <- read_csv(here("data", "analysis_data", "coordinates_data.csv"))

# Get bounding box for Toronto (approximate limits for Toronto)
toronto_bbox <- c(-79.6303856025883, 43.5822069220627, -79.1180336515019, 43.8554571861712)

# Fetch map data from OpenStreetMap (OSM)
toronto_map <- opq(bbox = toronto_bbox) %>%
  add_osm_feature(key = 'highway', value = 'primary') %>%
  osmdata_sf()

# Convert map data to Simple Features (sf) objects
streets <- toronto_map$osm_lines

# Plot the map with bike lanes data
ggplot() +
  geom_sf(data = streets, color = "gray", size = 0.3, alpha = 0.6) +  # OSM street map layer
  geom_point(data = coordinates_data, aes(x = longitude, y = latitude), 
             size = 0.1, color = "black") +  # Bike lanes points
  labs(x = "Longitude", y = "Latitude") +
  coord_sf(xlim = c(-79.6303856025883, -79.1180336515019), 
           ylim = c(43.5822069220627, 43.8554571861712), expand = FALSE) +
  theme_minimal() +
  theme(
    panel.background = element_blank(),  # Remove panel background
    panel.grid.major = element_blank(),  # Remove major grid lines
    panel.grid.minor = element_blank(),  # Remove minor grid lines
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

```

@fig-map provides a visual representation of the bike lane infrastructure across Toronto. The lines on the map correspond to various cycling paths, including dedicated bike lanes, multi-use paths, and shared roadways, which span different areas of the city. The geographic coordinates, ranging from around 43.60°N to 43.85°N in latitude and -79.6°W to -79.3°W in longitude, encompass most of Toronto’s urban region. This map offers an important spatial perspective, illustrating the extensive network of cycling routes that connect different neighborhoods and areas within the city.

A key observation from the map is the dense concentration of bike lanes in the downtown core and along major roadways, indicating a well-established network in central Toronto. The downtown area’s grid-like structure is particularly evident, showcasing a high density of lanes that facilitate easy cycling access within the city's busiest areas. As one moves further away from the city center, the map shows fewer bike lanes, suggesting that suburban regions may have less developed cycling infrastructure. However, there are notable multi-use paths extending toward the outskirts, particularly in parks and recreational areas, providing important cycling connections for those commuting or using bikes for recreational purposes.

This map highlights the importance of cycling infrastructure in promoting sustainable urban transportation. The wide distribution of bike lanes supports Toronto's efforts to enhance active transportation options, reduce traffic congestion, and improve accessibility for cyclists. The representation also provides a foundation for analyzing areas where future infrastructure developments could be prioritized, particularly in regions where cycling connectivity appears sparse.

# Discussion {#sec-dis}

## Development of Toronto's Cycling Infrastructure

The data reveals a phased development of Toronto's cycling infrastructure, with a notable increase in installations during the early 2000s, as shown in @fig-installed. This rise is likely due to the dataset commencing in 2001, thereby consolidating all installations prior to this year. Additionally, the onset of formal record-keeping and the significant number of installations during this period may reflect political momentum and public demand for environmentally sustainable transportation alternatives, influenced by growing concerns over climate change and urban congestion.

Ignoring the data from the first year, the annual number of new bikeway installations still showing a trend of slight decreasing. Several factors may account for this decline. In the early stages, the city's cycling plan likely targeted areas where infrastructure could be installed with relative ease, particularly in downtown Toronto, where road networks and urban density favored such investments. As the network extended into more complex regions, such as suburban areas with fewer existing roadways, the rate of installation slowed. Moreover, the physical limitations of space in a densely developed urban environment likely constrained further expansion, as new bikeways would require more complex and expensive measures, such as road reallocation or the creation of shared-use paths.

Despite this slowdown in new installations, @fig-upgraded demonstrates a substantial focus on upgrading existing infrastructure, particularly in recent years. This shift from new installations to upgrades may indicate a strategic decision by the city to enhance the quality and safety of the current cycling infrastructure. As the infrastructure ages and new safety standards are introduced, upgrading older lanes is essential to ensuring the network remains functional and safe for cyclists. The peak of upgrades in 2015, for instance, may reflect the city's response to increased cycling activity, advocacy group demands, or the adoption of updated cycling policies that prioritize safer designs, such as protected bike lanes.

The shift toward prioritizing upgrades over new installations also suggests that the initial expansion left certain areas with inadequate or unsafe infrastructure, particularly in the form of shared roadways or painted bike lanes offering minimal cyclist protection. As urban transportation planning evolves, the emphasis has shifted toward constructing more segregated and protected lanes, which are vital for encouraging cycling among less experienced riders, families, or individuals concerned about safety. Considering new plans by the goverment [@citeCyclingNetworkPlan], this ongoing focus on improving infrastructure—rather than simply expanding it—reflects a more advanced approach to active transportation, recognizing that safety and quality are equally important to increasing cycling participation.

In conclusion, the analysis highlights the progression of Toronto’s cycling infrastructure from an initial phase of rapid expansion to a more recent emphasis on upgrading and enhancing the safety and quality of the network. This evolution reflects the complexities of balancing growth with maintenance, the need to adapt to changing urban environments, and the influence of international best practices and local advocacy in shaping the future of cycling in Toronto.

## Comfort Level and Cyclist Safety

The classification of comfort levels in Toronto's cycling infrastructure offers significant insights into the city's capacity to ensure cyclist safety and encourage widespread usage. According to the Bikeway Comfort Level Distribution, @fig-comfort-one-1, a large portion of the network consists of lanes categorized as either High or Low Comfort, with Moderate Comfort lanes representing a smaller percentage. This distribution indicates that, although Toronto has expanded its cycling network, the infrastructure may still lack the protection required to encourage consistent cycling across a broader demographic. Ideally, Low Comfort lanes should form the smallest proportion, ensuring safer and more accessible routes for cyclists of all experience levels.

Comfort level classification is crucial for determining which segments of the population feel confident using the cycling network. Low Comfort lanes, including painted bike lanes and shared roadways, provide minimal physical separation from vehicular traffic. This limited protection often discourages risk-averse cyclists, particularly in areas with high traffic volumes. While such lanes may be acceptable in quieter residential areas, they are often avoided in busy urban environments. Unfortunately, as @fig-comfort-one-2 shows, 77.31% of these Low Comfort lanes remain unupgraded, revealing a substantial gap in the network's ability to offer safe and comfortable conditions for all cyclists.

Moderate Comfort lanes, which provide a higher degree of separation but still lack full physical barriers, also face similar issues. As indicated in @fig-comfort-two-1, 76.62% of Moderate Comfort lanes have not been upgraded. This shortfall presents a significant challenge in attracting cyclists to busier, high-traffic areas where perceived risk is still considerable. While Moderate Comfort lanes are an improvement over Low Comfort options, they may not sufficiently address the safety concerns of groups particularly sensitive to danger, such as women, children, and older adults.

In conclusion, while Toronto has made progress in expanding its cycling network, the high proportion of unupgraded lanes underscores the need for further improvements. The city should prioritize upgrading its Low and Moderate Comfort lanes while continuing to expand its High Comfort infrastructure. This shift will not only improve safety but also enhance equity in urban transportation, making cycling a more viable and appealing option for a diverse range of residents.

## Geospatial Distribution and Expansion Challenges

The geospatial analysis of Toronto's cycling infrastructure, as shown in @fig-map, reveals both strengths and gaps in the city's bike network. One key observation is the dense concentration of bikeways in the downtown core. This concentration aligns with expectations, given that downtown Toronto is the city's most populated and congested area, with high demand for alternative transportation options. The extensive network of bikeways in this region reflects a targeted effort to make cycling a viable and accessible mode of transportation for residents, commuters, and visitors.

However, @fig-map also reveals a significant disparity in infrastructure coverage as one moves away from the city center toward suburban and peripheral areas. In these regions, cycling infrastructure is sparse, underscoring unequal access to safe and efficient bike routes. This limited infrastructure in suburban areas reduces the overall utility of the city's cycling network, as it disproportionately benefits those residing in the urban core. Suburban residents, often facing longer commutes and a greater dependence on automobiles, would benefit from an expanded bike lane network, providing a safer and more convenient alternative to driving.

Several factors contribute to this discrepancy in cycling infrastructure. Suburban areas typically have lower population densities and roadways designed primarily for car travel, which historically has deprioritized cycling in urban planning. Additionally, suburban cultures often rely heavily on automobiles, leading to lower public demand for bike lanes. As Toronto aims to promote sustainable transportation and reduce car dependency, prioritizing the development of safe cycling routes in suburban areas will be essential. Expanding infrastructure in these regions can significantly contribute to the city’s broader transportation and environmental goals.

@fig-map also emphasizes the importance of recreational areas, particularly those near the waterfront, in shaping the cycling network. These areas often feature multi-use trails with High Comfort lanes, offering cyclists scenic and safe routes away from motor traffic. These trails serve not only as commuting routes but also as recreational spaces, promoting exercise and relaxation.

Finally, @fig-map points to opportunities for future expansion. Areas with few or no cycling routes should be considered for infrastructure development, especially where there is sufficient road space or public demand for safer cycling options. As Toronto continues to grow, addressing these gaps in the cycling network will be critical to ensuring that all residents, regardless of location, have access to safe, comfortable, and convenient cycling infrastructure. Expanding the network equitably across the city will support the development of a more inclusive and sustainable transportation system.

In conclusion, while the spatial distribution of Toronto's cycling infrastructure demonstrates a well-connected downtown core, it also highlights the need for further investment in suburban regions. Expanding the cycling network in underserved areas will be crucial for promoting cycling as a practical and widely adopted mode of transportation throughout the city.

## Weaknesses and next steps

One key limitation of this study is the reliance on the 'Cycling Network' dataset from OpenDataToronto, which, while comprehensive, might not capture informal or emerging cycling routes that are not officially recognized. Additionally, the dataset may not include newer infrastructure developments if updates were delayed in publication. Future research should integrate real-time data collection techniques or alternative datasets (e.g., crowdsourced information) to ensure that the analysis reflects the most current state of the network.

Another weakness lies in the classification of comfort levels, which, while useful, is a simplification. Comfort in cycling can be influenced by numerous factors beyond infrastructure type, such as traffic density, road conditions, and seasonal weather. A more nuanced classification that incorporates these additional factors could provide a more accurate assessment of how comfortable Toronto's cycling network truly is for different types of cyclists.

Next steps should include focusing on identifying areas with fewer bike lanes and lower comfort levels, particularly in suburban areas. These regions could be targeted for infrastructure upgrades and expansion to promote greater equity in access to safe cycling options. Additionally, analyzing cycling usage patterns, perhaps through mobile GPS data or surveys, would offer valuable insights into how the infrastructure is being utilized, helping city planners to make data-driven decisions in future expansions or upgrades.



\newpage



\appendix



# Appendix {#sec-app}

## Comfort Levels Classification {#sec-app-comfort}

### Data

```{r}
#| echo: false
#| eval: true
#| label: tbl-comfort
#| tbl-cap: "INFRA_HIGHORDER and INFRA_LOWORDER Columns from Raw Data"
#| warning: false

# Load the dataset
data <- read_csv(here("data", "raw_data", "raw_data.csv"))

comfort_data <- data %>%
  select(INFRA_HIGHORDER, INFRA_LOWORDER)

head(comfort_data) %>%
  kable("latex", booktabs = TRUE, col.names = c("INFRA_HIGHORDER", "INFRA_LOWORDER"))

```

The classification relies on the infrastructure types defined in two key columns: INFRA_HIGHORDER and INFRA_LOWORDER, shown in @tbl-comfort. As the author explained on the original dataset page [@citeCyclingNetwork]: "'INFRA-HIGH' refers to the highest classified cycling infrastructure type installed on this segment. 'INFRA-LOW' refers to the lowest classified cycling infrastructure type. The hierarchy is based on the quality and comfort of the bikeway type, with routes that are shared with vehicles as the lowest comfort, and the greater the separation / dedicated space, the higher the comfort and classification."

Both columns are crucial because they give complementary information about the physical features of the bikeway. By selecting these columns and ensuring that no missing values remain, the dataset is prepared for classification.

### Logic

The comfort levels are defined using a custom classification scheme based on the infrastructure types. The classification assigns a comfort level to each bikeway segment depending on its physical characteristics and separation from traffic:

#### High Comfort
Segments with infrastructure types labeled as "Protected" or "Multi-Use." These bikeways generally have physical barriers separating cyclists from motor vehicles, such as fully separated bike lanes or paths shared with pedestrians but removed from vehicle traffic. This category offers the highest level of safety and comfort, making it appealing to a wide range of cyclists, including families and less experienced riders.

#### Moderate Comfort
Bikeways labeled as "Bike Lane" in either column are classified as "Moderate Comfort." These lanes are typically painted or designated lanes on the road but lack the full physical separation that would offer more safety. While these lanes provide cyclists with their own space, they are adjacent to motor vehicle traffic, which may make them less comfortable for some users.

#### Low Comfort
All other types of bikeways, not falling into the protected or designated bike lane categories, are classified as "Low Comfort." These may include shared roadways where cyclists must navigate mixed traffic, offering little or no physical protection from vehicles. These segments are considered the least comfortable and safest for cyclists, often deterring usage by more risk-averse cyclists.

This classification method ensures that each bikeway segment is categorized into one of the three comfort levels based on its infrastructure type, enabling a detailed analysis of the usability of Toronto's cycling network.

\newpage



# References


